#!/usr/local/bin/bqn

# S - price of underlying asset (at time t)
# K - strike price
# Ï„ - time until contract maturity (T - t) in years
# Ïƒ - volatility of underlying asset
# r - interest rate
# c - 0 for call, 1 for put
# n - number of rows in binomial tree
inputs â† 100â€¿100â€¿1â€¿0.20â€¿0.05â€¿0â€¿5000

 â€¢Show â‰ âŸ¨
   "underlying price (Sâ‚œ)",
   "strike price (K)",
   "time until maturity (T - t)",
   "Estimated Volatility (Ïƒ)",
   "Interest Rate (r)",
   "Call or Put (0 âˆ¨ 1)",
   "Depth of Binomial Tree (n)",
 âŸ© â‰ inputs

# Applies the Binomial Options Pricing model to discretely
# approximate the fair value of an option.
#
# inputs:
# S - price of underlying asset (at time t)
# K - strike price
# Ï„ - time until contract maturity (T - t) in years
# Ïƒ - volatility of underlying asset
# r - interest rate
# c - 0 for call, 1 for put
# n - number of rows in binomial tree
#
# outputs:
# Value  (V) - theoretical fair value of the option.
#
# https://en.wikipedia.org/wiki/Binomial_options_pricing_model#Method

Binomial â† {
  sâ€¿kâ€¿tâ€¿vâ€¿râ€¿câ€¿n â† ğ•©

  dt â† t Ã· n # Î”t represents time slice for one layer of binomial tree
  dâ€¿u â† Ã·âŠ¸â‹ˆ â‹† v Ã— âˆšdt
  p â† u Ã·Ëœâ—‹(-âŸœd) â‹†rÃ—dt # probability that option value increases at Î”t
  b â† s Ã— u â‹† (âŠ¢-2Ã—Â·â†•1âŠ¸+) n # bottom row of binomial tree
  max â† 0 âŒˆ k c â—¶ (-Ëœ)â€¿- b # option values at bottom row
  exp â† â‹† Â¯1 Ã— r Ã— Ã·n

  (exp Ã— p (âŠ¢â‹ˆ1âŠ¸-)âŠ¸(+Â´Ã—)â‰0â€¿1 2âŠ¸â†•)âŸn max
}

outputs â† Binomial inputs

â€¢Show â‰ âŸ¨
  "Theoretical Value (V)",
âŸ© â‰ outputs
